### DOCKER IMAGE ###
1. docker build -t presentation:1.0.0 .
2. docker tag presentation:1.0.0 uyahya/presentation:1.0.0
3. docker push uyahya/presentation:1.0.0
docker run -d -p 8080:8080 --name presentation:1.0.0

### INSTALLATION ###

https://docs.flagger.app/install/flagger-install-on-kubernetes

helm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx
kubectl create ns ingress-nginx
helm upgrade -i ingress-nginx ingress-nginx/ingress-nginx \
--namespace ingress-nginx \
--set controller.metrics.enabled=true \
--set controller.podAnnotations."prometheus\.io/scrape"=true \
--set controller.podAnnotations."prometheus\.io/port"=10254

helm repo add flagger https://flagger.app

helm upgrade -i flagger flagger/flagger \
--namespace ingress-nginx \
--set prometheus.install=true \
--set meshProvider=nginx

# Send traffic to the Pod
while ($true) {
    kubectl get canaries
    curl http://localhost:8080/good
    Start-Sleep -Seconds 5
}
